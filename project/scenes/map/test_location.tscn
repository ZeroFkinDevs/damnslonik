[gd_scene load_steps=31 format=4 uid="uid://chkxcrr31soaw"]

[ext_resource type="Texture2D" uid="uid://sadpx7gtolb3" path="res://resources/textures/map/bg.png" id="1_ego3u"]
[ext_resource type="Texture2D" uid="uid://d1wb76lbbs4oc" path="res://resources/textures/light.png" id="2_00w1a"]
[ext_resource type="Script" uid="uid://0l48qq2bw8rl" path="res://scripts/entity/interactive/ladder_interaction_test.gd" id="3_rq0pi"]
[ext_resource type="Texture2D" uid="uid://6on376qpwcvd" path="res://resources/textures/map/ladder.png" id="4_7afpg"]
[ext_resource type="Script" uid="uid://bh865ey6mwdk0" path="res://scripts/narrative/test/test_narrative.gd" id="5_aiht2"]
[ext_resource type="Texture2D" uid="uid://cc77hem76415g" path="res://resources/textures/mef.png" id="6_v2omb"]
[ext_resource type="Script" uid="uid://dv2scs1f80n0x" path="res://scripts/narrative/test/mef_narrative.gd" id="7_3nflo"]
[ext_resource type="Texture2D" uid="uid://c8vy7hyf0aw2u" path="res://resources/textures/map/sewer.png" id="8_1erfc"]
[ext_resource type="Script" uid="uid://je6530bv1g7q" path="res://scripts/entity/player/player_spawner.gd" id="9_3ts7k"]
[ext_resource type="Script" uid="uid://brpgurmger6ol" path="res://scripts/entity/interactive/ladder.gd" id="10_pjug5"]
[ext_resource type="Texture2D" uid="uid://cdqdup1iv4sk5" path="res://resources/textures/map/street/street_without_bg.png" id="11_4km2n"]
[ext_resource type="Script" uid="uid://b5cpkqujdl1hu" path="res://scripts/entity/interactive/hatch.gd" id="12_ec2e4"]
[ext_resource type="Script" uid="uid://buftb2secsi62" path="res://scripts/entity/triggers/map_teleport_trigger.gd" id="13_dm6ao"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_sk2n7"]
size = Vector2(54, 124)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_uprbi"]
size = Vector2(114, 109)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_p7tj1"]
size = Vector2(78, 64)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_2yw5f"]
size = Vector2(79.49829, 27.65149)

[sub_resource type="AtlasTexture" id="AtlasTexture_5fjt0"]
atlas = ExtResource("11_4km2n")
region = Rect2(1183.8535, 472.47717, 76.76172, 128.07745)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_mrhu1"]
size = Vector2(47.526123, 94.83331)

[sub_resource type="AtlasTexture" id="AtlasTexture_usayd"]
atlas = ExtResource("11_4km2n")
region = Rect2(1166.2908, 647.0247, 122.60278, 44.337463)

[sub_resource type="Animation" id="Animation_8q7ur"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Node2D:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("ladder:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(-0.86413574, 96.78047)]
}

[sub_resource type="Animation" id="Animation_a7ivt"]
resource_name = "close"
step = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Node2D:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.3, 0.5, 0.7),
"transitions": PackedFloat32Array(1.2311442, 0.20306355, 2.219139, 0.51763254),
"update": 0,
"values": [1.748819910498318, 0.0, 0.2642021, 0.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("ladder:position")
tracks/1/interp = 2
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.3),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(-0.864, -40), Vector2(-0.864, 96.78)]
}

[sub_resource type="Animation" id="Animation_aj2qc"]
resource_name = "open"
step = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Node2D:rotation")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.3, 0.5),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [0.0, 1.8143518, 1.7483643]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("ladder:position")
tracks/1/interp = 2
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.2, 1),
"transitions": PackedFloat32Array(1, 0.2973018, 1),
"update": 0,
"values": [Vector2(-0.86413574, 96.78047), Vector2(-0.86413574, 96.78047), Vector2(-0.864, -40)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_7jigp"]
_data = {
&"RESET": SubResource("Animation_8q7ur"),
&"close": SubResource("Animation_a7ivt"),
&"open": SubResource("Animation_aj2qc")
}

[sub_resource type="RectangleShape2D" id="RectangleShape2D_rb2gb"]
size = Vector2(120.975586, 102.829254)

[sub_resource type="OccluderPolygon2D" id="OccluderPolygon2D_b51pg"]
polygon = PackedVector2Array(-64, -54.857143, 64, -54.857143, 64, 64, -64, 64)

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_0yauj"]
texture = ExtResource("8_1erfc")
texture_region_size = Vector2i(128, 128)
0:0/0 = 0
0:0/0/occlusion_layer_0/polygon_0/polygon = SubResource("OccluderPolygon2D_b51pg")
0:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-64, -64, 64, -64, 64, 64, -64, 64)

[sub_resource type="TileSet" id="TileSet_21p7k"]
tile_size = Vector2i(128, 128)
occlusion_layer_0/light_mask = 1
physics_layer_0/collision_layer = 17
physics_layer_0/collision_mask = 17
sources/0 = SubResource("TileSetAtlasSource_0yauj")

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_ego3u"]
texture = ExtResource("8_1erfc")
texture_region_size = Vector2i(128, 128)
0:0/0 = 0
0:0/0/occlusion_layer_0/polygon_0/polygon = SubResource("OccluderPolygon2D_b51pg")
0:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-64, -64, 64, -64, 64, 64, -64, 64)

[sub_resource type="TileSet" id="TileSet_00w1a"]
tile_size = Vector2i(128, 128)
occlusion_layer_0/light_mask = 1
physics_layer_0/collision_layer = 1
sources/0 = SubResource("TileSetAtlasSource_ego3u")

[node name="TestLocation" type="Node2D"]
texture_filter = 1

[node name="CanvasModulate" type="CanvasModulate" parent="."]
color = Color(0.29954746, 0.29954746, 0.29954743, 1)

[node name="Parallax2D" type="Parallax2D" parent="."]
scroll_scale = Vector2(0.8, 0.8)

[node name="Bg" type="Sprite2D" parent="Parallax2D"]
position = Vector2(627, 481)
scale = Vector2(2.6693118, 2.669312)
texture = ExtResource("1_ego3u")

[node name="PointLight2D2" type="PointLight2D" parent="."]
texture_filter = 1
position = Vector2(895, 361)
energy = 1.84
shadow_enabled = true
texture = ExtResource("2_00w1a")
texture_scale = 1.27

[node name="PointLight2D" type="PointLight2D" parent="."]
texture_filter = 1
position = Vector2(335, 362)
energy = 1.7
shadow_enabled = true
texture = ExtResource("2_00w1a")
texture_scale = 1.27

[node name="Ladder" type="Area2D" parent="." node_paths=PackedStringArray("narrative", "display_point")]
position = Vector2(197, 455)
collision_layer = 2
collision_mask = 2
script = ExtResource("3_rq0pi")
narrative = NodePath("Narrative")
label = "Ladder"
display_point = NodePath("display point")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Ladder"]
position = Vector2(0, -6)
shape = SubResource("RectangleShape2D_sk2n7")

[node name="Ladder" type="Sprite2D" parent="Ladder"]
position = Vector2(-9, 16.25)
scale = Vector2(0.16499999, 0.16499999)
texture = ExtResource("4_7afpg")

[node name="Ladder2" type="Sprite2D" parent="Ladder"]
position = Vector2(-9, -65.99997)
scale = Vector2(0.16499999, 0.16499999)
texture = ExtResource("4_7afpg")

[node name="Ladder3" type="Sprite2D" parent="Ladder"]
position = Vector2(-9, -145.99997)
scale = Vector2(0.16499999, 0.16499999)
texture = ExtResource("4_7afpg")

[node name="Ladder4" type="Sprite2D" parent="Ladder"]
position = Vector2(-9, -227)
scale = Vector2(0.16499999, 0.16499999)
texture = ExtResource("4_7afpg")

[node name="Ladder5" type="Sprite2D" parent="Ladder"]
position = Vector2(-9, -307)
scale = Vector2(0.16499999, 0.16499999)
texture = ExtResource("4_7afpg")

[node name="display point" type="Node2D" parent="Ladder"]
position = Vector2(-1, -50)

[node name="Narrative" type="Node" parent="Ladder"]
script = ExtResource("5_aiht2")

[node name="Ladder2" type="Area2D" parent="." node_paths=PackedStringArray("narrative", "display_point")]
position = Vector2(1146, 458)
collision_layer = 2
collision_mask = 2
script = ExtResource("3_rq0pi")
narrative = NodePath("Narrative")
label = "мефчик"
display_point = NodePath("display point")

[node name="Sprite2D2" type="Sprite2D" parent="Ladder2"]
position = Vector2(1, 23.000061)
scale = Vector2(0.13080165, 0.1308016)
texture = ExtResource("6_v2omb")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Ladder2"]
position = Vector2(0, 26.5)
shape = SubResource("RectangleShape2D_uprbi")

[node name="display point" type="Node2D" parent="Ladder2"]
position = Vector2(2, 25)

[node name="RigidBody2D" type="RigidBody2D" parent="Ladder2"]
position = Vector2(-6, -519)
metadata/_edit_group_ = true

[node name="Sprite2D" type="Sprite2D" parent="Ladder2/RigidBody2D"]
scale = Vector2(0.13080165, 0.1308016)
texture = ExtResource("6_v2omb")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Ladder2/RigidBody2D"]
shape = SubResource("RectangleShape2D_p7tj1")

[node name="RigidBody2D2" type="RigidBody2D" parent="Ladder2"]
position = Vector2(-42, -589)
metadata/_edit_group_ = true

[node name="Sprite2D" type="Sprite2D" parent="Ladder2/RigidBody2D2"]
scale = Vector2(0.13080165, 0.1308016)
texture = ExtResource("6_v2omb")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Ladder2/RigidBody2D2"]
shape = SubResource("RectangleShape2D_p7tj1")

[node name="RigidBody2D3" type="RigidBody2D" parent="Ladder2"]
position = Vector2(14, -666)
metadata/_edit_group_ = true

[node name="Sprite2D" type="Sprite2D" parent="Ladder2/RigidBody2D3"]
scale = Vector2(0.13080165, 0.1308016)
texture = ExtResource("6_v2omb")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Ladder2/RigidBody2D3"]
shape = SubResource("RectangleShape2D_p7tj1")

[node name="RigidBody2D4" type="RigidBody2D" parent="Ladder2"]
position = Vector2(-19, -742)
metadata/_edit_group_ = true

[node name="Sprite2D" type="Sprite2D" parent="Ladder2/RigidBody2D4"]
scale = Vector2(0.13080165, 0.1308016)
texture = ExtResource("6_v2omb")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Ladder2/RigidBody2D4"]
shape = SubResource("RectangleShape2D_p7tj1")

[node name="RigidBody2D5" type="RigidBody2D" parent="Ladder2"]
position = Vector2(-3, -820)
metadata/_edit_group_ = true

[node name="Sprite2D" type="Sprite2D" parent="Ladder2/RigidBody2D5"]
scale = Vector2(0.13080165, 0.1308016)
texture = ExtResource("6_v2omb")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Ladder2/RigidBody2D5"]
shape = SubResource("RectangleShape2D_p7tj1")

[node name="Narrative" type="Node" parent="Ladder2" node_paths=PackedStringArray("boxes")]
script = ExtResource("7_3nflo")
boxes = [NodePath("../RigidBody2D"), NodePath("../RigidBody2D2"), NodePath("../RigidBody2D3"), NodePath("../RigidBody2D4"), NodePath("../RigidBody2D5")]

[node name="PlayerSpawner" type="Node2D" parent="."]
position = Vector2(74, 414.00003)
scale = Vector2(0.436, 0.436)
script = ExtResource("9_3ts7k")
code = "hatch_0"

[node name="foreground" type="Node2D" parent="."]
z_index = 2
position = Vector2(75.00001, 50.000004)
rotation = 3.1415925
scale = Vector2(0.50456446, 0.5045646)

[node name="hatch" type="Area2D" parent="foreground" node_paths=PackedStringArray("animation_player", "display_point")]
position = Vector2(4.5776367e-05, -600.51776)
scale = Vector2(1.9819071, 1.9819067)
collision_layer = 2
collision_mask = 2
script = ExtResource("12_ec2e4")
animation_player = NodePath("AnimationPlayer")
label = "hatch"
display_point = NodePath("Node2D/Sprite2D5")
metadata/_custom_type_script = "uid://85bbajjok1x5"

[node name="Trigger" type="Area2D" parent="foreground/hatch"]
position = Vector2(0, 141.71426)
script = ExtResource("13_dm6ao")
map_code = "street"
spawn_code = "street_hatch_0"
metadata/_custom_type_script = "uid://cqx8uin01bujl"

[node name="CollisionShape2D" type="CollisionShape2D" parent="foreground/hatch/Trigger"]
shape = SubResource("RectangleShape2D_2yw5f")

[node name="ladder" type="Area2D" parent="foreground/hatch" node_paths=PackedStringArray("player_point")]
position = Vector2(-0.86413574, 96.78047)
script = ExtResource("10_pjug5")
right_direction = false
player_point = NodePath("Node2D")

[node name="Sprite2D6" type="Sprite2D" parent="foreground/hatch/ladder"]
modulate = Color(0.5132329, 0.5132329, 0.5132329, 1)
position = Vector2(-0.020885509, -0.80836487)
texture = SubResource("AtlasTexture_5fjt0")
flip_h = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="foreground/hatch/ladder"]
position = Vector2(-1.2961426, 47.63617)
shape = SubResource("RectangleShape2D_mrhu1")

[node name="Node2D" type="Node2D" parent="foreground/hatch/ladder"]
position = Vector2(-17.282335, 0.00047467055)

[node name="Node2D" type="Node2D" parent="foreground/hatch"]
position = Vector2(54.43903, 14.689893)

[node name="Sprite2D5" type="Sprite2D" parent="foreground/hatch/Node2D"]
modulate = Color(0.5132329, 0.5132329, 0.5132329, 1)
position = Vector2(-55.30314, -17.282227)
texture = SubResource("AtlasTexture_usayd")

[node name="AnimationPlayer" type="AnimationPlayer" parent="foreground/hatch"]
libraries = {
&"": SubResource("AnimationLibrary_7jigp")
}

[node name="CollisionShape2D" type="CollisionShape2D" parent="foreground/hatch"]
position = Vector2(0, -35.860596)
shape = SubResource("RectangleShape2D_rb2gb")

[node name="StaticBody2D" type="StaticBody2D" parent="foreground/hatch"]
collision_layer = 16
collision_mask = 16

[node name="CollisionShape2D2" type="CollisionShape2D" parent="foreground/hatch/StaticBody2D"]
position = Vector2(0, 164.18118)
shape = SubResource("RectangleShape2D_2yw5f")

[node name="TileMapLayer" type="TileMapLayer" parent="foreground"]
position = Vector2(148.643, 99.0953)
rotation = -3.1415925
scale = Vector2(1.981907, 1.9819065)
tile_map_data = PackedByteArray("AAAAAAQAAAAAAAAAAAABAAQAAAAAAAAAAAACAAQAAAAAAAAAAAADAAQAAAAAAAAAAAAEAAQAAAAAAAAAAAAFAAQAAAAAAAAAAAAGAAQAAAAAAAAAAAAHAAQAAAAAAAAAAAAIAAQAAAAAAAAAAAAJAAQAAAAAAAAAAAAKAAQAAAAAAAAAAAALAAQAAAAAAAAAAAA=")
tile_set = SubResource("TileSet_21p7k")

[node name="TileMapLayer2" type="TileMapLayer" parent="foreground"]
position = Vector2(2879.711, 693.66736)
rotation = -3.1415925
scale = Vector2(1.981907, 1.9819065)
tile_map_data = PackedByteArray("AAAAAAQAAAAAAAAAAAABAAQAAAAAAAAAAAACAAQAAAAAAAAAAAADAAQAAAAAAAAAAAAEAAQAAAAAAAAAAAAFAAQAAAAAAAAAAAAGAAQAAAAAAAAAAAAHAAQAAAAAAAAAAAAIAAQAAAAAAAAAAAAJAAQAAAAAAAAAAAAKAAQAAAAAAAAAAAALAAQAAAAAAAAAAAALAAMAAAAAAAAAAAAKAAMAAAAAAAAAAAAJAAMAAAAAAAAAAAALAAIAAAAAAAAAAAAKAAIAAAAAAAAAAAAJAAIAAAAAAAAAAAAIAAMAAAAAAAAAAAAIAAIAAAAAAAAAAAAMAAMAAAAAAAAAAAAMAAIAAAAAAAAAAAA=")
tile_set = SubResource("TileSet_00w1a")
